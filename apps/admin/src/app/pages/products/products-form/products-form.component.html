<p-toast></p-toast>
<div class="admin-page">
    <p-card  [header]="editMode ? 'Editar producto' : 'Crear producto'" subheader="Aquí podrás crear o editar un producto.">
        <div class="p-grid p-mb-5">
            <div class="p-col-12">
                <p-toolbar>
                    <div class="p-toolbar-group-left"></div>
                    <div class="p-toolbar-group-right">
                        <p-button (click)="onSubmit()" class="p-mr-2" 
                        [label]="editMode ? 'Editar' : 'Crear'" 
                        icon="pi pi-plus" styleClass="p-button-primary" ></p-button>
                        <p-button label="Cancelar" icon="pi pi-arrow-circle-left" styleClass="p-button-secondary" routerLink="/products"></p-button>
                    </div>
                </p-toolbar>
            </div>
        </div>
        <div class="p-grid">
            <div class="p-col-12">
                <form [formGroup]="form">
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col">
                            <label for="name">Nombre</label>
                            <input formControlName="name" id="name" type="text" pInputText> 
                            <small *ngIf="productForm.name.invalid && isSubmitted" class="p-error">El nombre es obligatorio</small>
                        </div>
                        <div class="p-field p-col">
                            <label for="brand">Marca</label>
                            <input formControlName="brand" id="brand" type="text" pInputText> 
                            <small *ngIf="productForm.brand.invalid && isSubmitted" class="p-error">La maraca es obligatoria</small>
                        </div>
                        <div class="p-field p-col">
                            <label for="price">Precio</label><br>
                            <p-inputNumber formControlName="price" mode="currency" currency="EUR" locale="es-ES" inputId="price" [useGrouping]="false">
                            </p-inputNumber>
                            <small *ngIf="productForm.price.invalid && isSubmitted" class="p-error">El precio es obligatorio</small>
                        </div>
                    </div>
                    <div class="p-fluid p-formgrid p-grid">
                        <div class="p-field p-col-4">
                            <label for="countInStock">Stock</label><br>
                            <p-inputNumber formControlName="countInStock" mode="decimal" inputId="countInStock" [useGrouping]="false">
                            </p-inputNumber>
                            <small *ngIf="productForm.countInStock.invalid && isSubmitted" class="p-error">El stock es obligatorio</small>
                        </div>
                        <div class="p-field p-col-4">
                            <label for="category">Categoría</label><br>   

                            <p-dropdown  [options]="categories" formControlName="category" optionLabel="name" placeholder="Selecciona la categoría" optionValue="id" [filter]="true" filterBy="name" [showClear]="true"></p-dropdown>

                            <small *ngIf="productForm.category.invalid && isSubmitted" class="p-error">La categoría es obligatoria</small>
                        </div>
                        <div class="p-field p-col-4">
                            <label for="isFeatured">Producto destacado</label><br>   
                            <p-inputSwitch formControlName="isFeatured"></p-inputSwitch>
                            
                        </div>
                        <div class="p-field p-col-12">
                            <label for="description">Descripción breve</label><br>
                            <textarea [rows]="7" formControlName="description" pInputTextarea></textarea>
                            <small *ngIf="productForm.description.invalid && isSubmitted" class="p-error">La descripción es obligatoria</small>
                        </div>
                        <div class="p-field p-col-12">
                            <label for="richDescription">Descripción detallada </label><br>
                            <p-editor  formControlName="richDescription" [style]="{'height':'320px'}"></p-editor>
                        </div>
                        <div class="p-field p-col-12">
                            <label for="image">Imagen principal</label>
                            <input class="p-inputtext" type="file" accept="image/*" (change)="onImageUpload($event)">
                            <small *ngIf="productForm.image.invalid && isSubmitted" class="p-error">La imagen es obligatoria</small>

                            <div class="p-col-2 p-mt-3 p-pl-0">
                                <img style="width: 100%;" [src]="imageDisplay">
                            </div>
                        </div>
                    
                    </div>
                </form>
            </div>
        </div>
    </p-card>
</div>
